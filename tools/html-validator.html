<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Validator - Multi-Tools Hub</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../assets/css/style.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/eclipse.min.css">
    <!-- HTMLHint -->
    <script src="https://cdn.jsdelivr.net/npm/htmlhint@0.15.1/dist/htmlhint.min.js"></script>
</head>
<body>
    <!-- Header will be dynamically loaded here -->
    <div id="header-container"></div>

    <main class="container my-4">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="card">
                    <div class="card-body">
                        <h1 class="card-title text-center mb-4">HTML Validator</h1>
                        
                        <!-- Tool Description -->
                        <p class="text-muted text-center mb-4">
                            Validate and clean HTML code with various options and real-time feedback.
                        </p>

                        <!-- Validation Options -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Validation Options</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkDoctype" checked>
                                            <label class="form-check-label" for="checkDoctype">Check DOCTYPE</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkTags" checked>
                                            <label class="form-check-label" for="checkTags">Check Tags</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkAttributes" checked>
                                            <label class="form-check-label" for="checkAttributes">Check Attributes</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkAccessibility" checked>
                                            <label class="form-check-label" for="checkAccessibility">Check Accessibility</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkPerformance" checked>
                                            <label class="form-check-label" for="checkPerformance">Check Performance</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="checkSEO" checked>
                                            <label class="form-check-label" for="checkSEO">Check SEO</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cleaning Options -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Cleaning Options</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="removeComments">
                                            <label class="form-check-label" for="removeComments">Remove Comments</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="removeEmptyTags">
                                            <label class="form-check-label" for="removeEmptyTags">Remove Empty Tags</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="removeWhitespace">
                                            <label class="form-check-label" for="removeWhitespace">Remove Extra Whitespace</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="formatOutput" checked>
                                            <label class="form-check-label" for="formatOutput">Format Output</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="lowercaseTags" checked>
                                            <label class="form-check-label" for="lowercaseTags">Lowercase Tags</label>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="quoteAttributes" checked>
                                            <label class="form-check-label" for="quoteAttributes">Quote Attributes</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Editor and Output -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card h-100">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5 class="mb-0">Input</h5>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-secondary" id="clearInput">
                                                <i class="fas fa-trash"></i> Clear
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary" id="pasteInput">
                                                <i class="fas fa-paste"></i> Paste
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <textarea id="input"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card h-100">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5 class="mb-0">Output</h5>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-secondary" id="clearOutput">
                                                <i class="fas fa-trash"></i> Clear
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary" id="copyOutput">
                                                <i class="fas fa-copy"></i> Copy
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary" id="downloadOutput">
                                                <i class="fas fa-download"></i> Download
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <textarea id="output"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Validation Results -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <h5 class="mb-0">Validation Results</h5>
                            </div>
                            <div class="card-body">
                                <div id="validationResults" class="mb-3">
                                    <div class="alert alert-success d-none" id="successAlert">
                                        <i class="fas fa-check-circle"></i> HTML is valid!
                                    </div>
                                    <div class="alert alert-danger d-none" id="errorAlert">
                                        <i class="fas fa-exclamation-circle"></i> <span id="errorCount">0</span> errors found
                                    </div>
                                    <div id="errorList" class="list-group"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Code Analysis -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <h5 class="mb-0">Code Analysis</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Lines of Code</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="lineCount" readonly>
                                                <span class="input-group-text">lines</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Tags</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="tagCount" readonly>
                                                <span class="input-group-text">tags</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Attributes</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="attrCount" readonly>
                                                <span class="input-group-text">attrs</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">File Size</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="fileSize" readonly>
                                                <span class="input-group-text">bytes</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Common Examples -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <h5 class="mb-0">Common Examples</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Basic HTML5</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="<!DOCTYPE html><html><head><title>Page Title</title></head><body><h1>Hello World</h1></body></html>" readonly>
                                                <button class="btn btn-outline-primary use-example">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Form Example</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="<form><div><label>Name:</label><input type='text'></div><div><label>Email:</label><input type='email'></div><button type='submit'>Submit</button></form>" readonly>
                                                <button class="btn btn-outline-primary use-example">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Table Example</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="<table><thead><tr><th>Name</th><th>Age</th></tr></thead><tbody><tr><td>John</td><td>25</td></tr></tbody></table>" readonly>
                                                <button class="btn btn-outline-primary use-example">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">List Example</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="<ul><li>Item 1</li><li>Item 2</li><li>Item 3</li></ul>" readonly>
                                                <button class="btn btn-outline-primary use-example">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ad Space -->
                <div class="ad-space mt-4">
                    Ad Space
                </div>
            </div>
        </div>
    </main>

    <!-- Footer will be dynamically loaded here -->
    <div id="footer-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- CodeMirror -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
    <!-- Custom JS -->
    <script src="../assets/js/main.js"></script>
    <script>
        // Load components
        document.addEventListener('DOMContentLoaded', function() {
            loadComponents();
            initializeHTMLValidator();
        });

        function initializeHTMLValidator() {
            // DOM Elements
            const input = document.getElementById('input');
            const output = document.getElementById('output');
            const clearInput = document.getElementById('clearInput');
            const pasteInput = document.getElementById('pasteInput');
            const clearOutput = document.getElementById('clearOutput');
            const copyOutput = document.getElementById('copyOutput');
            const downloadOutput = document.getElementById('downloadOutput');
            const successAlert = document.getElementById('successAlert');
            const errorAlert = document.getElementById('errorAlert');
            const errorCount = document.getElementById('errorCount');
            const errorList = document.getElementById('errorList');
            const lineCount = document.getElementById('lineCount');
            const tagCount = document.getElementById('tagCount');
            const attrCount = document.getElementById('attrCount');
            const fileSize = document.getElementById('fileSize');

            // Initialize CodeMirror
            const inputEditor = CodeMirror.fromTextArea(input, {
                mode: 'htmlmixed',
                theme: 'monokai',
                lineNumbers: true,
                lineWrapping: true,
                autoCloseTags: true,
                autoCloseBrackets: true,
                matchTags: true,
                indentUnit: 4
            });

            const outputEditor = CodeMirror.fromTextArea(output, {
                mode: 'htmlmixed',
                theme: 'eclipse',
                lineNumbers: true,
                lineWrapping: true,
                readOnly: true
            });

            // Process HTML
            function processHTML() {
                const html = inputEditor.getValue();
                if (!html) {
                    outputEditor.setValue('');
                    updateAnalysis(0, 0, 0, 0);
                    return;
                }

                // Get validation options
                const options = {
                    'doctype-first': document.getElementById('checkDoctype').checked,
                    'tag-pair': document.getElementById('checkTags').checked,
                    'attr-lowercase': document.getElementById('checkAttributes').checked,
                    'alt-require': document.getElementById('checkAccessibility').checked,
                    'script-disabled': document.getElementById('checkPerformance').checked,
                    'title-require': document.getElementById('checkSEO').checked
                };

                // Validate HTML
                const messages = HTMLHint.verify(html, options);
                const hasErrors = messages.length > 0;

                // Update validation results
                successAlert.classList.toggle('d-none', hasErrors);
                errorAlert.classList.toggle('d-none', !hasErrors);
                errorCount.textContent = messages.length;

                // Clear and update error list
                errorList.innerHTML = '';
                messages.forEach(message => {
                    const li = document.createElement('div');
                    li.className = 'list-group-item list-group-item-danger';
                    li.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Line ${message.line}:</strong> ${message.message}
                            </div>
                            <button class="btn btn-sm btn-outline-danger" onclick="navigateToLine(${message.line})">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    `;
                    errorList.appendChild(li);
                });

                // Clean HTML
                let cleanedHTML = html;

                if (document.getElementById('removeComments').checked) {
                    cleanedHTML = cleanedHTML.replace(/<!--[\s\S]*?-->/g, '');
                }

                if (document.getElementById('removeEmptyTags').checked) {
                    cleanedHTML = cleanedHTML.replace(/<(\w+)(?:\s+[^>]*)?>\s*<\/\1>/g, '');
                }

                if (document.getElementById('removeWhitespace').checked) {
                    cleanedHTML = cleanedHTML.replace(/\s+/g, ' ').trim();
                }

                if (document.getElementById('formatOutput').checked) {
                    cleanedHTML = formatHTML(cleanedHTML);
                }

                if (document.getElementById('lowercaseTags').checked) {
                    cleanedHTML = cleanedHTML.replace(/<(\/?)([A-Z][A-Z0-9]*)\b/g, (match, slash, tag) => {
                        return `<${slash}${tag.toLowerCase()}`;
                    });
                }

                if (document.getElementById('quoteAttributes').checked) {
                    cleanedHTML = cleanedHTML.replace(/(\w+)=([^"'\s>]+)/g, '$1="$2"');
                }

                // Update output
                outputEditor.setValue(cleanedHTML);

                // Update analysis
                const lines = cleanedHTML.split('\n').length;
                const tags = (cleanedHTML.match(/<[^!][^>]*>/g) || []).length;
                const attrs = (cleanedHTML.match(/\s+\w+="[^"]*"/g) || []).length;
                const size = new Blob([cleanedHTML]).size;

                updateAnalysis(lines, tags, attrs, size);
            }

            // Format HTML
            function formatHTML(html) {
                let formatted = '';
                let indent = 0;
                const lines = html.split('\n');

                lines.forEach(line => {
                    const trimmed = line.trim();
                    if (trimmed) {
                        if (trimmed.startsWith('</')) {
                            indent--;
                        }
                        formatted += '  '.repeat(indent) + trimmed + '\n';
                        if (!trimmed.startsWith('</') && trimmed.endsWith('>') && !trimmed.endsWith('/>')) {
                            indent++;
                        }
                    }
                });

                return formatted;
            }

            // Update analysis
            function updateAnalysis(lines, tags, attrs, size) {
                lineCount.value = lines;
                tagCount.value = tags;
                attrCount.value = attrs;
                fileSize.value = size;
            }

            // Navigate to line
            window.navigateToLine = function(line) {
                inputEditor.setCursor({ line: line - 1, ch: 0 });
                inputEditor.focus();
            };

            // Clear input
            clearInput.addEventListener('click', function() {
                inputEditor.setValue('');
                processHTML();
            });

            // Paste input
            pasteInput.addEventListener('click', async function() {
                try {
                    const text = await navigator.clipboard.readText();
                    inputEditor.setValue(text);
                    processHTML();
                } catch (error) {
                    alert('Failed to paste text. Please check clipboard permissions.');
                }
            });

            // Clear output
            clearOutput.addEventListener('click', function() {
                outputEditor.setValue('');
                updateAnalysis(0, 0, 0, 0);
            });

            // Copy output
            copyOutput.addEventListener('click', async function() {
                try {
                    await navigator.clipboard.writeText(outputEditor.getValue());
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Copied';
                    setTimeout(() => {
                        this.innerHTML = originalText;
                    }, 1000);
                } catch (error) {
                    alert('Failed to copy HTML. Please check clipboard permissions.');
                }
            });

            // Download output
            downloadOutput.addEventListener('click', function() {
                const html = outputEditor.getValue();
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'index.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });

            // Use example
            document.querySelectorAll('.use-example').forEach(button => {
                button.addEventListener('click', function() {
                    const input = this.previousElementSibling;
                    const currentValue = inputEditor.getValue();
                    const newValue = currentValue ? currentValue + '\n\n' + input.value : input.value;
                    inputEditor.setValue(newValue);
                    processHTML();
                });
            });

            // Event listeners for options
            document.querySelectorAll('input[type="checkbox"], select').forEach(element => {
                element.addEventListener('change', processHTML);
            });

            // Update on input change
            inputEditor.on('change', processHTML);

            // Initial setup
            processHTML();
        }
    </script>
    <style>
        .CodeMirror {
            height: 500px;
            font-family: monospace;
            font-size: 14px;
        }
        .input-group input[readonly] {
            background-color: #f8f9fa;
        }
        .list-group-item {
            margin-bottom: 0.5rem;
        }
    </style>
</body>
</html> 